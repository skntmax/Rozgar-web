/*!
 *  GMAP3 Plugin for jQuery
 *  Version  : 7.2
 *  Date     : 2016/12/03
 *  Author   : DEMONTE Jean-Baptiste
 *  Contact  : jbdemonte@gmail.com
 *  Web site : http://gmap3.net
 *  Licence  : GPL-3.0+
 */
!function(n,t,e){"use strict";var o,r,i,u,a,c={},s=n.when,f=n.extend,l=n.isArray,p=n.isFunction,g=n.Deferred;function d(n){return f(!0,{},n||{})}function h(){var n=Array.prototype.slice,t=n.call(arguments,1);return n.apply(arguments[0],t)}function v(n){return void 0===n}function y(t){return s.apply(n,t)}function m(n){return s().then((function(){return n}))}function L(n){return c[n]||(c[n]=w(n)),c[n]}function w(n){var t=o[n];function e(n){return t.apply(this,n)}return e.prototype=t.prototype,new e(h(arguments,1))}function x(n,t){P(n.split(" "),t)}function P(n,t){(l(n)?n:[n]).forEach(t)}function b(n){return Object.keys(n)}function M(n){return b(n).map((function(t){return n[t]}))}function B(n,t){return(n=d(n)).bounds&&(n.bounds=j(n.bounds)),m(t(n))}function C(n,t,e){var r=g();return n=d(n),s().then((function(){var e=n.address;if(e)return delete n.address,function(n){var t=g();return"string"==typeof n&&(n={address:n}),L("Geocoder").geocode(n,(function(n,e){e===o.GeocoderStatus.OK?t.resolve(n[0].geometry.location):t.reject(e)})),t}(e).then((function(e){n[t]=e}));n[t]=E(n[t])})).then((function(){r.resolve(e(n))})).fail((function(n){r.reject(n)})),r}function T(n,t,e){return(n=d(n))[t]=(n[t]||[]).map(E),m(e(n))}function E(n,t){return l(n)?new o.LatLng(n[0],n[1]):!t||!n||n instanceof o.LatLng?n:new o.LatLng(n.lat,n.lng)}function j(n,t){return l(n)?new o.LatLngBounds({lat:n[2],lng:n[3]},{lat:n[0],lng:n[1]}):t&&!n.getCenter?new o.LatLngBounds({lat:n.south,lng:n.west},{lat:n.north,lng:n.east}):n}function D(t,r){var i=o.OverlayView,u=n(e.createElement("div")).css({border:"none",borderWidth:0,position:"absolute"}).append(r.content);function a(){var n=this;function e(t){return n.getProjection().fromLatLngToDivPixel(t)}i.call(n),n.setMap(t),n.onAdd=function(){n.getPanes().overlayMouseTarget.appendChild(u[0])},r.position?(n.getPosition=function(){return r.position},n.setPosition=function(t){r.position=t,n.draw()},n.draw=function(){var n=e(r.position);u.css({left:n.x+r.x+"px",top:n.y+r.y+"px"})}):(n.getBounds=function(){return r.bounds},n.setBounds=function(t){r.bounds=t,n.draw()},n.draw=function(){var n=e(r.bounds.getSouthWest()),t=e(r.bounds.getNorthEast());u.css({left:n.x+r.x+"px",top:t.y+r.y+"px",width:t.x-n.x+r.x+"px",height:n.y-t.y+r.y+"px"})}),n.$=u}return(r=f({x:0,y:0},r)).position?r.position=E(r.position,!0):r.bounds&&(r.bounds=j(r.bounds,!0)),a.prototype=new i,new a}function O(n,t,e,o){var r=this;r.cluster=n,r.markers=t,r.$=e.$,r.overlay=e,e.getBounds=function(){return w("LatLngBounds",o.getSouthWest(),o.getNorthEast())}}function S(n,t){var e,r,i,u,a,c=this,s=[],f=(t.size||200)>>1,l=!0,p={},g=[];function v(){var e,o,r,v,y,m,L,x,M,B,C,T,E,j,S,_,k=n.getZoom(),A={},R=[],I={};m=""+k,k>3&&(o=w("Circle",{center:n.getCenter(),radius:1.15*(L=n.getCenter(),x=n.getBounds().getNorthEast(),M=Math,B=M.PI,C=B*L.lat()/180,T=B*L.lng()/180,E=B*x.lat()/180,j=B*x.lng()/180,S=M.cos,_=M.sin,6371e3*M.acos(M.min(S(C)*S(E)*S(T)*S(j)+S(C)*_(T)*S(E)*_(j)+_(C)*_(E),1)))}).getBounds(),P(s,(function(n,t){o.contains(n.getPosition())||(m+="-"+t,I[t]=!0,n.getMap()&&n.setMap(null))}))),a&&P(s,(function(n,t){I[t]||a(n)||(m+="-"+t,I[t]=!0,n.getMap()&&n.setMap(null))})),m!==i&&(i=m,P(s,(function(i,a){var g,m;I[a]||(e=[a],g=i.getPosition(),m=u.fromLatLngToDivPixel(g),o=w("LatLngBounds",u.fromDivPixelToLatLng(w("Point",m.x-f,m.y+f)),u.fromDivPixelToLatLng(w("Point",m.x+f,m.y-f))),l&&P(h(s,a+1),(function(n,t){!I[t+=a+1]&&o.contains(n.getPosition())&&(e.push(t),I[t]=!0)})),v=e.join("-"),A[v]=!0,p[v]||(y=e.map((function(n){return s[n]})),(r=t.cb(h(y)))?(o=w("LatLngBounds"),P(y,(function(n){o.extend(n.getPosition()),n.getMap()&&n.setMap(null)})),(r=d(r)).position=o.getCenter(),p[v]=new O(c,h(y),D(n,r),o),R.push(p[v])):P(y,(function(t){t.getMap()||t.setMap(n)}))))})),P(b(p),(function(n){A[n]||(p[n].overlay.setMap(null),delete p[n])})),R.length&&P(g,(function(n){n(R)})))}function y(){clearTimeout(e),e=setTimeout(v,100)}(t=t||{}).markers=t.markers||[],c._b=function(n){n(M(p)),g.push(n)},c.markers=function(){return h(s)},c.groups=function(){return M(p)},c.enable=function(){l||(l=!0,i="",y())},c.disable=function(){l&&(l=!1,i="",y())},c.add=function(n){s.push(n),i="",y()},c.remove=function(n){s=s.filter((function(t){return t!==n})),i="",y()},c.filter=function(n){a!==n&&(a=n,i="",y())},r=setInterval((function(){u=function(n){function t(){var n=this;return n.onAdd=n.onRemove=n.draw=function(){},o.OverlayView.call(n)}t.prototype=new o.OverlayView;var e=new t;return e.setMap(n),e.getProjection()}(n),u&&(clearInterval(r),o.event.addListener(n,"zoom_changed",y),o.event.addListener(n,"bounds_changed",y),v())}),10)}function _(n,t){var e=this;b(t[0]).forEach((function(n){e[n]=function(){var o=[],r=h(arguments);return t.forEach((function(t){o.push(t[n].apply(t,r))})),"get"===n?o.length>1?o:o[0]:e}})),e.$=n}function k(t,e){var r,i=[],u=s(),a=this;function c(){return{$:t,get:a.get}}function f(t,e,r,i){var u=arguments.length>3;u||(i=r),n.each(t,(function(n,t){P(e,(function(e){var a=e instanceof O,s=a||e instanceof o.OverlayView,f=s?e.$.get(0):e;o.event["add"+(s?"Dom":"")+"Listener"+(i?"Once":"")](f,n,(function(n){P(t,(function(t){if(p(t))if(a)t.call(c(),void 0,e,e.cluster,n);else if(u){var o=h(r);o.unshift(e),o.push(n),t.apply(c(),o)}else t.call(c(),e,n)}))}))}))}))}function b(n){return function(t){if(l(t)){var e=[],o=t.map((function(t){return n.call(a,t).then((function(n){e.push(n)}))}));return y(o).then((function(){return i.push(e),e}))}return n.apply(a,arguments).then((function(n){return i.push(n),n}))}}function M(n){return function(){var t=h(arguments);return u=u.then((function(e){return p(t[0])?s(t[0].call(c(),e)).then((function(e){return t[0]=e,n.apply(a,t)})):s(n.apply(a,t))}))}}a.map=M((function(n){return r||C(n,"center",(function(n){return r=w("Map",t.get(0),n),i.push(r),r}))})),x("Marker:position Circle:center InfoWindow:position:0 Polyline:path Polygon:paths",(function(n){var t=(n=n.split(":"))[1]||"";a[n[0].toLowerCase()]=M(b((function(e){return(t.match(/^path/)?T:C)(e,t,(function(t){return"0"!==n[2]&&(t.map=r),w(n[0],t)}))})))})),x("TrafficLayer TransitLayer BicyclingLayer",(function(n){a[n.toLowerCase()]=M((function(){var t=w(n);return i.push(t),t.setMap(r),t}))})),a.kmllayer=M(b((function(n){return(n=d(n)).map=r,s(w("KmlLayer",n))}))),a.rectangle=M(b((function(n){return B(n,(function(n){return n.map=r,w("Rectangle",n)}))}))),a.overlay=M(b((function(n){function t(n){return D(r,n)}return(n=d(n)).bounds?B(n,t):C(n,"position",t)}))),a.groundoverlay=M((function(n,t,e){return B({bounds:t},(function(t){(e=d(e)).map=r;var o=w("GroundOverlay",n,t.bounds,e);return i.push(o),o}))})),a.styledmaptype=M((function(n,t,e){var o=w("StyledMapType",t,e);return i.push(o),r.mapTypes.set(n,o),o})),a.streetviewpanorama=M((function(t,e){return C(e,"position",(function(e){var o=w("StreetViewPanorama",n(t).get(0),e);return r.setStreetView(o),i.push(o),o}))})),a.route=M((function(n){var t=g();return(n=d(n)).origin=E(n.origin),n.destination=E(n.destination),L("DirectionsService").route(n,(function(n,e){i.push(n),t.resolve(e===o.DirectionsStatus.OK&&n)})),t})),a.cluster=M((function(n){var t=new S(r,d(n));return i.push(t),m(t)})),a.directionsrenderer=M((function(t){var e;return t&&((t=d(t)).map=r,t.panel&&(t.panel=n(t.panel).get(0)),e=w("DirectionsRenderer",t)),i.push(e),e})),a.latlng=M(b((function(n){return C(n,"latlng",(function(n){return i.push(n.latlng),n.latlng}))}))),a.fit=M((function(){var n=w("LatLngBounds");return P(i,(function(t){t!==r&&P(t,(function(t){t&&(t.getPosition&&t.getPosition()?n.extend(t.getPosition()):t.getBounds&&t.getBounds()?(n.extend(t.getBounds().getNorthEast()),n.extend(t.getBounds().getSouthWest())):t.getPaths&&t.getPaths()?P(t.getPaths().getArray(),(function(t){P(t.getArray(),(function(t){n.extend(t)}))})):t.getPath&&t.getPath()?P(t.getPath().getArray(),(function(t){n.extend(t)})):t.getCenter&&t.getCenter()&&n.extend(t.getCenter()))}))})),n.isEmpty()||r.fitBounds(n),!0})),a.wait=function(n){u=u.then((function(t){var e=g();return setTimeout((function(){e.resolve(t)}),n),e}))},a.then=function(n){p(n)&&(u=u.then((function(t){return s(n.call(c(),t)).then((function(n){return v(n)?t:n}))})))},a.catch=function(n){p(n)&&(u=u.then(null,(function(t){return s(n.call(c(),t))})))},x("on once",(function(n,t){a[n]=function(){var n=arguments[0];n&&("string"==typeof n&&((n={})[arguments[0]]=h(arguments,1)),u.then((function(e){if(e){if(e instanceof S)return e._b((function(e){e&&e.length&&f(n,e,t)})),f(n,e.markers(),[void 0,e],t);f(n,e,t)}})))}})),a.get=function(n){return v(n)?i.map((function(n){return l(n)?n.slice():n})):(n<0&&(n=i.length+n),l(i[n])?i[n].slice():i[n])},e&&a.map(e)}s((a=g(),n.holdReady(!0),u=function(){var o;t.google&&t.google.maps||!1===r?a.resolve():(t.__gmap3=function(){delete t.__gmap3,a.resolve()},(i=e.createElement("script")).type="text/javascript",i.src="https://maps.googleapis.com/maps/api/js?callback=__gmap3"+(r?"&"+("string"==typeof r?r:b(o=r).map((function(n){return encodeURIComponent(n)+"="+encodeURIComponent(o[n])})).join("&")):""),n("head").append(i))},"loading"!=e.readyState?u():e.addEventListener("DOMContentLoaded",u),a)).then((function(){n.holdReady(!1)})),n.gmap3=function(n){r=n},n.fn.gmap3=function(e){var r=[];return o=t.google.maps,this.each((function(){var t=n(this),o=t.data("gmap3");o||(o=new k(t,e),t.data("gmap3",o)),r.push(o)})),new _(this,r)}}(jQuery,window,document);